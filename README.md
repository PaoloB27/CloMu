# CloMu
CloMu is a neural network based software for cancer phylogeny analysis.

Dependencies: pytorch, numpy.

# How to use CloMu:

CloMu.py contains the CloMu software to be used on any data set. 

analysis.py contains specific analysis code used to write the CloMu paper. 


To train a model, run the code:

python CloMu.py train (input format) (input files) (model file) (tree probability file) (mutation name file) (maximum tree length) (optional arguements) 

As an example, one can run the below code:

python CloMu.py train raw ./data/realData/breastCancer.npy ./model.pt ./prob.npy ./mutationNames.npy 9

To be specific, "input format" can either be "raw" or "multi". If using raw, "input files" should be the name of the input file with a list of all trees for all patients. "model file" should be the location you want the model to be stored. "tree probability file" should be the location you want to put the predicted probability for each tree in the input data. "mutation name file" should be the name of the file where you want to store the ordered list of mutation names in your data set. "maximum tree length" should be the maximum tree size you want to analyze. Setting it below the length of the longest tree in your data will simply remove patients with a longer tree sizes. "optional arguements" are additional optional inputs you can add. 

One optional arguement is "-noInfiniteSites", to disable the infinite sites assumption. Below is an example of running the code with this.

python3 CloMu.py train raw ./data/realData/AML.npy ./temp/model.pt ./temp/prob.npy ./temp/mutationNames.npy 10 -noInfiniteSites

Another optional arguement is "-trainSize" followed by an integer number of data points to train on. Below is an example using that feature. 

python CloMu.py train raw ./data/realData/breastCancer.npy ./model.pt ./prob.npy ./mutationNames.npy 9  -trainSize 200

In addition to the raw input format, we also accept an input format consisting of multiple files. In that case, "input format" should be "multi". Then 'input files" should be (file with a list of trees) (file with the patient number of each tree) (file with the length of each tree). An example is below. 

python CloMu.py train multi ./data/simulations/I-a/T_4_R_0_bulkTrees.npz ./data/simulations/I-a/T_4_R_0_bulkSample.npz ./data/simulations/I-a/T_4_R_0_treeSizes.npz  ./model.pt ./prob.npy ./mutationNames.npy 10 -trainSize 500

# The data sets provided. 
In data/simulations/ there are all simulated data sets used in the paper labeled by their name in the paper. In data/realData are the two real data sets used in the paper. For all simulations generated by us (all simulations other than (III) and (IV), each data set contains twice as many patients as was used in the paper. Only the first half of patients are used for any analysis. The second half of patients (1) allow for other researchers to utilize an exactly identicle set up with more patients if they wish (2) act as a never used test set for researchers interested in using our simulations on a task that requires a seperate test set. 










 


